# 🏰 One-Yuan-Red-Chamber (红楼梦·癸酉本 AI 精修重写计划)

## Try it = 用不到1元，让 DeepSeek 替曹雪芹“写完”后 28 回。

> **"字字看来皆是血，十年辛苦不寻常。" —— 曹雪芹**
>
> **"三分钟跑完一章节，九毛钱重写后二十八回。" —— DeepSeek**

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)[![Model](https://img.shields.io/badge/Model-DeepSeek%20V3-brightgreen)](https://www.deepseek.com/)[![License](https://img.shields.io/badge/license-MIT-green)](LICENSE)

<p align="center">
  <img src="./assets/Gemini_Generated_Image_hghtxchghtxchght.png" width="100%" alt="项目架构图" />
</p>


## 📖 精选摘录 (Highlights)

#### 【壹 · 黛玉归天】(第97回)

> “黛玉靠着一株垂柳喘息……将头颈往绳圈里一伸……恍惚间听得仙乐袅袅，只见一群仙女簇拥着一女子飘然而至，竟是秦可卿。……紫鹃遍寻不着，忽见柳叶渚边槐影森森，但见一株老槐横斜水畔，枝桠间悬着个素白身影，不是黛玉却是谁？这一惊非同小可，魂魄都散了，扑上前抱住双腿，只觉触手冰凉。正是：绛珠还泪本前盟，冷月寒塘葬玉魂。”

#### 【贰 · 凤姐之死】(第88回)

> “凤姐冻醒过来……浑身作烧，面上通红，实在捱不过，只呆呆望着窗外一弯细月。暗想：‘我聪明一世，人称脂粉英雄，如今自作自受遭此报应，活着有何趣味？’遂解下腰间汗巾，往监栅高处一抛，系个死结，将头探入，双脚一蹬。恍惚间见可卿隐隐在前，叹道：‘婶子实在痴了，竟将当年之托忘却。如今提也无益，快随我去见仙姑，在情榜上销号罢。’”

#### 【叁 · 探春远嫁】(第90回)

> “探春便往园子里来，只见两个小丫头在台阶上放风筝，不觉苦笑道：‘放得好，线一断便再回不来了。放风筝，放纷争，风筝尚能放走，这纷争怎的永无了时？’说着泪如雨下。……探春望着茫茫江水，想到此去三千里路，风霜雨雪难免颠簸，更兼骨肉家园从此永隔，坐在舱中不住垂泪。那船渐行渐远，贾府众人犹在岸上翘首目送，个个心如刀绞。”

#### 【肆 · 宝玉祭妹】(第106回)

> “宝玉弯腰拾起细看，大吃一惊，暗想：‘这不是那年我病中托晴雯送给林妹妹的旧帕么？’再一思量，豁然明白过来：‘这白骨……莫不就是我朝思暮想的林妹妹！’……良久，宝玉疯了似地扑到白骨上哭道：‘林妹妹，你死得好惨！神天菩萨，怎这般不公！别人都有寿终正寝之所，偏你孤零零葬在这荒渚野外，连个埋骨之地也无。我来迟了！我好恨！’”

#### 【伍 · 贾政之死】(第92回)

> “贾环嚷道：‘到这时候你还死倔，真真死不悔改。’说罢持剑往胸口一捅。可怜痴心父母训儿有方，竟招此杀身之祸。贾政在地上翻滚多时，两眼一瞪四肢松了，竟是去了。……邢夫人哭道：‘老爷莫寻短见，家里还指望你执掌门户！’贾政想到元春惨死，心如刀割，支持不住，又哭了几声昏倒在地。”

#### 【陆 · 宝钗结局】(第108回)

> “雨村、宝钗二人则发往东北苦寒之地充军。一路颠沛流离，风餐露宿，苦不堪言。这日行至风雪蛮荒之境，宝钗一病不起，虽百般埋怨雨村命途多舛，然何处寻得冷香丸调治？不过数日便香消玉殒，草草葬于雪中。正是：菟丝引蔓附蓬麻，积金攒玉谁嫌多。”

#### 【柒 · 惜春为尼】(第87回)

> “惜春仍自收拾，忽翻出一卷画来，原是当日受众人所托画的大观园全景。对着画怔了半晌，乃叹道：‘既一心向那清虚境界，怎可留恋人间俗物？这画儿也是尘缘，不必带了。’说罢仍放回箱中。……推门却见屋内空寂无人，唯余箱笼半开，哪里还有惜春踪影？不觉顿足道：‘好糊涂的孩子！’”

#### 【捌 · 迎春遗恨】(第87回)

> “绣桔泣不成声：‘那孙老爷逼着小姐多偷些值钱物件回来，谁知小姐空手而归，他便又打又骂。小姐哪敢分辩？自此便睡在柴房里，饥寒交迫。不过几日便……’宝玉听了，大叫一声：‘气杀我也！’哇的哭出声来，浑身乱颤道：‘好个无情兽，猪狗不如的豺狼！我这就去告官，再放把火烧了他这贼窝，方解心头之恨！’”

#### 【玖 · 巧姐获救】(第103回)

> “刘姥姥道：‘我是你远房亲戚，你该叫我姥姥的。’巧姐猛然想起从前父母提过，不觉‘哇’的一声扑进刘姥姥怀里。……刘姥姥领着众人踏进园子，只见残垣断壁，枯草摇曳。刘姥姥想起当年情景，放声哭道：‘老太太、姑奶奶，今儿又来看你们了！怎么一个个都去了，偏留下我这老妖精还活着……我把巧哥儿带回来了！’”

#### 【拾 · 湘云寒塘】(第107回)

> “湘云见那碑上镌着‘林黛玉’三字，顿觉天旋地转，扑到碑前哭道：‘姐姐那句“冷月葬花魂”，竟成谶语；我对的“寒塘渡鹤影”，又何尝不是今日写照。前儿我漂泊异乡，路过一片寒塘，从芦苇丛里穿行，真真叫人心碎。咱们怎么都这般命薄？’”

#### 【拾壹 · 妙玉沦落】(第102回)

> “妙玉几次寻死皆被阻住，又是几番责打，强架到后院叫那张员外奸淫了。……再想起与宝玉的奇缘，皆因自己懦弱孤僻错过，弄得遗憾终身。可叹妙玉一生，虽说有些孤高自许，世人难容，毕竟是个清洁身子，谁料到头来竟沦入风尘，过着腌臜日子，违背了一世心愿。”

#### 【拾贰 · 悬崖撒手】(第106回)

> “宝玉回头道：‘从此一刀两断，各奔前程，你们自保重罢。’说着快步便走。宝钗、麝月追赶不上，脚底生疼，喊得嗓子都哑了，眼睁睁见那身影消失在雪幕之中。……宝玉行至乡间，见一老妇倒卧雪中。细看竟是湘云，二人抱头痛哭。正是：寒冬噎酸齑，雪夜围破毡。途穷俗眼白，戍鼓扰人眠。”

#### 【拾叁 · 黛玉末世论】(第93回)

> “黛玉冷笑道：‘行凶倒说是行善，譬如我生个孩儿，疑心他长大作恶，便一把掐死了。再有一比：老子有过，儿子便可杀父，以“不善”行善，便是以“不当”为当。若人人效仿，振臂一呼，抓着旁人错处便去剿杀，恶人亦借行善之名作恶，世间不知要添多少冤魂！’”

#### 【拾肆 · 宝玉诔文】(第106回)

> “维干戈寥落之年……怡红院落魄公子含悲洒泪……思其容则清雅飘逸，堪同西子比娉婷；思其度娇姿弱态，敢与飞燕赛婵娟。……枫杨萧萧，阴阳浩浩，杳杳潜寐，千载不寤。年命譬如朝露，失我故欢；人生忽如风絮，余之永伤。”

#### 【拾伍 · 全书终了】(第108回)

> “那顽石经历这番梦幻，看尽人间悲欢离合、兴衰荣辱，早把尘缘看破。从此巍然屹立峰下，沐日月精华，受雨露滋润，复归本真。后人有诗叹云：豪华去后笙歌散，兴亡阅尽泪难干。妆台鸾镜事已空，碧草寒垄情似烟。”

## 📖 项目简介 (Introduction)

本项目是一个基于 LLM (Large Language Model) 的文学风格迁移与重写流水线（Pipeline）。

目标是将《红楼梦》**癸酉本（后二十八回）** 这一情节虽虽然逻辑自洽但文笔极为粗糙的底稿，通过 **DeepSeek V3** 模型，进行**曹雪芹风格（前八十回）** 的深度润色与扩写。

本项目不仅包含了完整的 Python 处理脚本，还开源了最终生成的**全本精修版**文本。

### ✨ 核心特性 (Features)

* **黄金锚点 (Golden Anchors)**: 采用 Few-Shot Prompting 技术，固化“脂粉气、金石声、苍凉感”三种核心红楼文风，确保生成风格高度统一。
* **低成本高产出**: 利用 DeepSeek V3 的高性价比（全书 28 回重写成本 < ¥1.00），实现工业级的文学创作。
* **工程化流水线**:
    * `Smart Split`: 智能正则切分，保留对话完整性，自动去重与过滤批语。
    * `Asyncio`: 全异步并发生成，极速处理。
    * `Context Caching`: 利用缓存机制降低 API 成本。
* **逻辑修复**: 在 Prompt 层面修复原底稿中不合理的剧情突兀点，使其更符合原著人物逻辑。

## 📂 目录结构 (Structure)

```text
.
├── hlm_28.txt                  # 【原始底稿】癸酉本后28回原文
├── hlm_80.txt                  # 原著前80回（用于提取风格参考）
├── main-deepseek.ipynb         # 【核心代码】Jupyter Notebook 完整运行脚本
├── refiner_cache_ds.json       # 缓存文件（避免重复生成，节省 Token）
├── 【修改版】红楼梦_后二十八回_全本.txt  # 【最终成品】合并后的完整精修版
├── refined_chapters_pro_ds/    # 分章节精修结果目录
│   ├── refined_081_....txt
│   ├── refined_082_....txt
│   └── ...
└── temp_chapters_split/        # 中间产物：原始底稿的切分片段
````

## 📊 资源消耗统计 (Resource Usage)

| 指标 (Metric)          | 数值 (Value) | 说明 (Note)                            |
| :--------------------- | :----------- | :------------------------------------- |
| **Input (Cache Hit)**  | `43,072`     | 命中上下文缓存（System Prompt/Anchor） |
| **Input (Cache Miss)** | `186,127`    | 新鲜输入文本（各章节底稿）             |
| **Output (Generated)** | `174,858`    | AI 实际撰写的正文内容                  |
| **Total Tokens**       | `404,057`    | 总吞吐量                               |
| **Total Cost**         | **¥0.90**    | **不到 1 元人民币！**                  |

![image-20251211183632466](./assets/image-20251211183632466.png)

## 🚀 快速开始 (Quick Start)

### 1\. 环境准备

需要安装以下 Python 库：

```bash
pip install openai tqdm
```

### 2\. 配置 API

打开 `main-deepseek.ipynb`，找到配置区域，填入你的 DeepSeek API Key：

```python
API_KEY = "sk-xxxxxxxxxxxx"  # 你的 DeepSeek Key
BASE_URL = "[https://api.deepseek.com](https://api.deepseek.com)"
```

### 3\. 运行重写引擎

运行 Notebook 中的 `main()` 函数。脚本将自动执行以下步骤：

1.  **清洗与切分**：将 `hlm_28.txt` 切分为独立的章节片段，自动去除干扰字符。
2.  **异步生成**：并发调用 DeepSeek API 进行风格迁移。
3.  **保存与合并**：生成的章节会自动保存在 `refined_chapters_pro_ds` 目录下。

### 4\. 合并全书

运行项目末尾的合并脚本，生成 `【修改版】红楼梦_后二十八回_全本.txt`。

## 📝 效果对比 (Showcase)

| 维度 | 癸酉本原稿 (Before) | DeepSeek 精修版 (After) |
| :--- | :--- | :--- |
| **描写** | 语言干瘪，只有情节大纲，缺乏环境渲染。 | 加入了细腻的景色、服饰、器物描写，还原“钟鸣鼎食”之家的质感。 |
| **对话** | 人物语气单一。 | 还原了明清白话，黛玉的尖刻、宝钗的圆融、凤姐的泼辣跃然纸上。 |
| **情节** | 剧情突兀（如直接勒死、甚至荒诞的暴力）。 | 增加了心理铺垫和氛围烘托，使悲剧的发生更具宿命感和合理性。 |

### 精彩片段修辞对比

#### 示例一：黛玉之死（第九十七回）

**背景**：黛玉误以为宝玉已死，又自觉误杀小红导致家败，绝望之下在柳叶渚上吊。

- **癸酉本原稿 (Raw Text):**

  > 黛玉道：“死了就死了，这些日子见过的死人够多了，我泪也流干了，心也变硬了。”...... 黛玉靠在一棵柳树上喘了口气...... 将头儿望绳里一伸，足儿一蹬，忽然眼前漆黑，辨不出方向。

- **DeepSeek 精修版 (Refined):**

  > 黛玉惨然一笑，那眼中早已干涸，竟是欲哭无泪，只道：“罢了！这一世的泪债，大约是还得尽了。那一堆堆白骨既是因我而起，我便拿这副残躯去抵偿便是。”......
  >
  > 此时冷月葬花，风透罗衣。黛玉倚在那株枯柳之上，喘息未定，回首望去，潇湘馆竹影凄迷，恰似前尘旧梦。她颤巍巍解下腰间丝绦，向那槐枝上一挂，叹道：“宝玉，我先去了，这一世的清白，也就留在这方寸之间罢！”言毕，把心一横，香魂一缕，竟随那满地落花随风散去了。

#### 示例二：贾政之死（第九十三回）

**背景**：贾环与赵姨娘带领流寇攻入贾府，贾环在争执中刺杀生父贾政。

- **癸酉本原稿 (Raw Text):**

  > 贾政捂着胸口道：“好，好的很！儿子会打老子了......”贾环嚷道：“都这个时候了你还死倔，可是死不悔改。”说完持剑只是往胸口一捅。...... 贾政在地上翻滚多时，两眼一瞪四肢一松，竟是去了。

- **DeepSeek 精修版 (Refined):**

  > 贾政手捂胸口，指着贾环，气得须发皆张，颤声道：“好孽障！不想我贾存周一生读书明理，竟养出你这等弑父灭伦的禽兽！”
  >
  > 贾环杀红了眼，满面狰狞，厉声喝道：“老爷此时还摆这父亲的款儿！既是你心里没我，今日便休怪儿子无情！”话音未落，手中利刃寒光一闪，直透胸膛。贾政身子一僵，一口鲜血喷出，那浑浊的老泪顺着眼角滚落，喉中格格作响，指着那匾额“荣禧堂”三字，却再也说不出一句话来，颓然倒地，气绝身亡。

#### 示例三：宝玉沦为乞丐（第一百七回）

**背景**：宝玉晚年落魄，在街头流浪。

- **癸酉本原稿 (Raw Text):**

  > 从此宝玉不敢再扮作和尚模样去化缘，只把衣裳撕破，做了乞丐云游四方，穷困潦倒。困了睡在破房古寺...... 宝玉流浪了大半年...... 当年的富贵闲人如今已瘦骨嶙峋。

- **DeepSeek 精修版 (Refined):**

  > 自此，世间少了一个多情公子，多了一个落魄乞儿。宝玉将那仅存的一领直裰撕作百结鹑衣，蓬头垢面，再难辨旧时容颜。
  >
  > 正值严冬，彤云密布，朔风凛冽。宝玉蜷缩于古庙残垣之下，腹中饥火如焚，身上寒彻入骨。想当年，那是何等锦衣玉食，便是那雀金裘稍有微瑕亦要心疼半日；看今朝，竟与野狗争食，共蓬蒿同眠。望着漫天飞雪，不由得痴了，恍惚间似见那红梅白雪琉璃世界中，仍有脂粉香气传来，伸手一抓，却只有满掌冰凉的雪水，和着那两行浊泪，一并咽下。

## ⚠️ 免责声明 (Disclaimer)

1.  本项目生成的文本仅供文学研究与技术交流使用。
2.  输入底稿来源于网络流传的“癸酉本”，版权归属原整理者所有。
3.  生成内容由 AI 产生，不代表项目维护者观点。

## 🤝 贡献 (Contributing)

欢迎提交 Issue 或 Pull Request，分享更好的 Prompt 策略或更优的参数配置（Temperature/Top\_P）。

参考数据集：https://github.com/vicalloy/the-guiyou-version-of-dream-of-the-red-chamber

## 📜 协议 (License)

MIT License © 2025 [Republic](https://github.com/Republic1024)

